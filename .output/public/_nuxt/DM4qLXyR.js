import{u as q,x as N,y as S,r as w,z as R,m as U,p as C,_ as P,A as k,c as y,b as l,w as t,E as D,B as T,o as F,C as B,a as K,n as L,D as M,G,H,I as z,J,K as O}from"./Bs-UNA1x.js";import{_ as Y}from"./DxmxW8HU.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */import{u as j,r as Q,n as x,a as g,e as W}from"./CxXkdaAk.js";/* empty css        */import{P as X}from"./e_-O8CN2.js";const Z={async setup(){const E=q(),o=N(),A=S(),e=w(new X),r=w({offset:0,limit:20,fullName:null,isActive:null,role:null,email:null,phone:null});r.value.offset=o.query.offset||0,r.value.limit=o.query.limit||20,r.value.fullName=o.query.fullName||null,r.value.email=o.query.email||null,o.query.isActive==="true"?r.value.isActive=!0:o.query.isActive==="false"&&(r.value.isActive=!1);const p=async n=>{r.value=n,e.value=await U("/user",r.value),A.push({path:o.path,query:{...r.value}})},m=async()=>{await p(r.value)},d=n=>{r.value.offset=n.offset,r.value.limit=n.limit,m()};p(r.value);const b=async n=>{const{error:i}=await C(`/user/${n.id}`,"DELETE",{},{async onResponse({request:a,response:h,options:I}){h.ok?x.deleted():x.error("Удаление запрещено!")},async onRequestError({request:a,options:h,error:I}){x.error()}},!1);i.value||e.value.items.splice(e.value.items.findIndex(a=>a.id===n.id),1)},V=R({email:[g,W],firstname:[g],lastname:[g]}),f=w(),s=R({id:null,isActive:!0,email:null,password:null,firstname:null,lastname:null}),c=async()=>{if(await j(f.value)){if(s.id){const{data:n,error:i}=await C(`/user/${s.id}`,"PATCH",{...s});i.value||e.value.items.splice(e.value.items.findIndex(a=>a.id===n.value.id),1,{...n.value})}if(!s.id){const{data:n,error:i}=await C("/user","POST",{...s});i.value||e.value.items.push({...n.value})}v()}},u=w(!1),_=n=>{if(Q(f.value),n)for(let i in n)s[i]=n[i];else{s.id=null;for(let i in s)s[i]=null}u.value=!0},v=()=>{u.value=!1};return{store:E,searchResult:e,searchForm:r,getList:p,onSearchFormChange:m,onSearchFormChangePagination:d,deleteItem:b,modal:u,openModal:_,closeModal:v,formRules:V,form:s,formRuleRef:f,submitForm:c}}},$={key:0},ee={key:1},le={class:"flex-center-row w-100"};function ae(E,o,A,e,r,p){const m=L,d=M,b=k("buttons-table"),V=D,f=Y,s=G,c=H,u=z,_=J,v=k("button-save"),n=O,i=T;return F(),y("div",null,[l(V,{data:e.searchResult.items,border:"",style:{width:"100%","margin-top":"15px"}},{default:t(()=>[l(m,{prop:"id",label:"ID",width:"60px"}),l(m,{label:"Active",align:"center","min-width":"110px"},{default:t(({row:a})=>[a.isActive?(F(),y("span",$,"Yes")):(F(),y("span",ee,"No"))]),_:1}),l(m,{prop:"fullName",label:"Name","min-width":"180px"},{header:t(()=>[l(d,{modelValue:e.searchForm.fullName,"onUpdate:modelValue":o[0]||(o[0]=a=>e.searchForm.fullName=a),placeholder:"Name",clearable:"",onClear:e.onSearchFormChange,onInput:e.onSearchFormChange},null,8,["modelValue","onClear","onInput"])]),_:1}),l(m,{prop:"email",label:"E-mail","min-width":"150px"},{header:t(()=>[l(d,{modelValue:e.searchForm.email,"onUpdate:modelValue":o[1]||(o[1]=a=>e.searchForm.email=a),placeholder:"E-mail",clearable:"",onClear:e.onSearchFormChange,onInput:e.onSearchFormChange},null,8,["modelValue","onClear","onInput"])]),_:1}),l(m,{prop:"createdAt",label:"Created At",width:"150"}),l(m,{prop:"action",label:"---",width:"118px"},{default:t(({row:a})=>[l(b,{"show-edit":!0,"show-delete":!0,onClickEdit:h=>e.openModal(a),onClickDelete:h=>e.deleteItem(a)},null,8,["onClickEdit","onClickDelete"])]),_:1})]),_:1},8,["data"]),l(f,{params:e.searchResult,onChange:e.onSearchFormChangePagination},null,8,["params","onChange"]),l(i,{modelValue:e.modal,"onUpdate:modelValue":o[7]||(o[7]=a=>e.modal=a),title:"User",width:"600",center:"","align-center":""},{default:t(()=>[l(n,{"label-position":"top",ref:"formRuleRef",model:e.form,rules:e.formRules,onKeyup:B(e.submitForm,["enter"])},{default:t(()=>[l(_,{gutter:15},{default:t(()=>[l(u,{span:24,xs:24},{default:t(()=>[l(c,{prop:"isActive",label:""},{default:t(()=>[l(s,{modelValue:e.form.isActive,"onUpdate:modelValue":o[2]||(o[2]=a=>e.form.isActive=a),"active-text":"Active"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{span:12,xs:24},{default:t(()=>[l(c,{prop:"firstname",label:"First name"},{default:t(()=>[l(d,{modelValue:e.form.firstname,"onUpdate:modelValue":o[3]||(o[3]=a=>e.form.firstname=a),placeholder:"First name"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{span:12,xs:24},{default:t(()=>[l(c,{prop:"lastname",label:"Last name"},{default:t(()=>[l(d,{modelValue:e.form.lastname,"onUpdate:modelValue":o[4]||(o[4]=a=>e.form.lastname=a),placeholder:"Last name"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(_,{gutter:15},{default:t(()=>[l(u,{span:12,xs:24},{default:t(()=>[l(c,{prop:"email",label:"E-mail"},{default:t(()=>[l(d,{modelValue:e.form.email,"onUpdate:modelValue":o[5]||(o[5]=a=>e.form.email=a),placeholder:"E-mail"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{span:12,xs:24},{default:t(()=>[l(c,{prop:"password",label:"Password"},{default:t(()=>[l(d,{modelValue:e.form.password,"onUpdate:modelValue":o[6]||(o[6]=a=>e.form.password=a),placeholder:"Password","show-password":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(c,null,{default:t(()=>[K("div",le,[l(v,{onClick:e.submitForm},null,8,["onClick"])])]),_:1})]),_:1},8,["model","rules","onKeyup"])]),_:1},8,["modelValue"])])}const fe=P(Z,[["render",ae]]);export{fe as default};
